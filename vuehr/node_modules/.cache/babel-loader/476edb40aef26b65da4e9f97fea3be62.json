{"remainingRequest":"F:\\java-workspace\\vhr\\vuehr\\node_modules\\babel-loader\\lib\\index.js!F:\\java-workspace\\vhr\\vuehr\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\java-workspace\\vhr\\vuehr\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\java-workspace\\vhr\\vuehr\\src\\components\\sys\\basic\\PermissionMana.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\java-workspace\\vhr\\vuehr\\src\\components\\sys\\basic\\PermissionMana.vue","mtime":1601998220457},{"path":"F:\\java-workspace\\vhr\\vuehr\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\java-workspace\\vhr\\vuehr\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\java-workspace\\vhr\\vuehr\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\java-workspace\\vhr\\vuehr\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUGVybWlzc2lvbk1hbmEiLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICByb2xlOiB7CiAgICAgICAgbmFtZTogJycsCiAgICAgICAgbmFtZVpoOiAnJwogICAgICB9LAogICAgICByb2xlczogW10sCiAgICAgIGFsbG1lbnVzOiBbXSwKICAgICAgYWN0aXZlTmFtZTogLTEsCiAgICAgIHNlbGVjdGVkTWVudXM6IFtdLAogICAgICBkZWZhdWx0UHJvcHM6IHsKICAgICAgICBjaGlsZHJlbjogJ2NoaWxkcmVuJywKICAgICAgICBsYWJlbDogJ25hbWUnCiAgICAgIH0KICAgIH07CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5pbml0Um9sZXMoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGRlbGV0ZVJvbGU6IGZ1bmN0aW9uIGRlbGV0ZVJvbGUocm9sZSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdGhpcy4kY29uZmlybSgn5q2k5pON5L2c5bCG5rC45LmF44CQJyArIHJvbGUubmFtZVpoICsgJ+OAkeinkuiJsiwg5piv5ZCm57un57utPycsICfmj5DnpLonLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpcy5kZWxldGVSZXF1ZXN0KCIvc3lzdGVtL2Jhc2ljL3Blcm1pc3Mvcm9sZS8iICsgcm9sZS5pZCkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgICAgaWYgKHJlc3ApIHsKICAgICAgICAgICAgX3RoaXMuaW5pdFJvbGVzKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnaW5mbycsCiAgICAgICAgICBtZXNzYWdlOiAn5bey5Y+W5raI5Yig6ZmkJwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBkb0FkZFJvbGU6IGZ1bmN0aW9uIGRvQWRkUm9sZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBpZiAodGhpcy5yb2xlLm5hbWUgJiYgdGhpcy5yb2xlLm5hbWVaaCkgewogICAgICAgIHRoaXMucG9zdFJlcXVlc3QoIi9zeXN0ZW0vYmFzaWMvcGVybWlzcy9yb2xlLyIsIHRoaXMucm9sZSkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgICAgaWYgKHJlc3ApIHsKICAgICAgICAgICAgX3RoaXMyLnJvbGUubmFtZVpoID0gJyc7CiAgICAgICAgICAgIF90aGlzMi5yb2xlLm5hbWUgPSAnJzsKCiAgICAgICAgICAgIF90aGlzMi5pbml0Um9sZXMoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLmlbDmja7kuI3lj6/ku6XkuLrnqboiKTsKICAgICAgfQogICAgfSwKICAgIGNhbmNlbFVwZGF0ZTogZnVuY3Rpb24gY2FuY2VsVXBkYXRlKCkgewogICAgICB0aGlzLmFjdGl2ZU5hbWUgPSAtMTsKICAgIH0sCiAgICBkb1VwZGF0ZTogZnVuY3Rpb24gZG9VcGRhdGUocmlkLCBpbmRleCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciB0cmVlID0gdGhpcy4kcmVmcy50cmVlW2luZGV4XTsKICAgICAgdmFyIHNlbGVjdGVkS2V5cyA9IHRyZWUuZ2V0Q2hlY2tlZEtleXModHJ1ZSk7CiAgICAgIHZhciB1cmwgPSAnL3N5c3RlbS9iYXNpYy9wZXJtaXNzLz9yaWQ9JyArIHJpZDsKICAgICAgc2VsZWN0ZWRLZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIHVybCArPSAnJm1pZHM9JyArIGtleTsKICAgICAgfSk7CiAgICAgIHRoaXMucHV0UmVxdWVzdCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgX3RoaXMzLmFjdGl2ZU5hbWUgPSAtMTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGNoYW5nZTogZnVuY3Rpb24gY2hhbmdlKHJpZCkgewogICAgICBpZiAocmlkKSB7CiAgICAgICAgdGhpcy5pbml0QWxsTWVudXMoKTsKICAgICAgICB0aGlzLmluaXRTZWxlY3RlZE1lbnVzKHJpZCk7CiAgICAgIH0KICAgIH0sCiAgICBpbml0U2VsZWN0ZWRNZW51czogZnVuY3Rpb24gaW5pdFNlbGVjdGVkTWVudXMocmlkKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdGhpcy5nZXRSZXF1ZXN0KCIvc3lzdGVtL2Jhc2ljL3Blcm1pc3MvbWlkcy8iICsgcmlkKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgaWYgKHJlc3ApIHsKICAgICAgICAgIF90aGlzNC5zZWxlY3RlZE1lbnVzID0gcmVzcDsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGluaXRBbGxNZW51czogZnVuY3Rpb24gaW5pdEFsbE1lbnVzKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHRoaXMuZ2V0UmVxdWVzdCgiL3N5c3RlbS9iYXNpYy9wZXJtaXNzL21lbnVzLyIpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgX3RoaXM1LmFsbG1lbnVzID0gcmVzcDsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGluaXRSb2xlczogZnVuY3Rpb24gaW5pdFJvbGVzKCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIHRoaXMuZ2V0UmVxdWVzdCgic3lzdGVtL2Jhc2ljL3Blcm1pc3MvIikudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICBfdGhpczYucm9sZXMgPSByZXNwOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["PermissionMana.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"permissionManaTool\">\r\n      <el-input size=\"small\" placeholder=\"请输入角色英文名\" v-model=\"role.name\">\r\n        <template slot=\"prepend\">ROLE_</template>\r\n      </el-input>\r\n      <el-input size=\"small\" placeholder=\"请输入角色中文名\" v-model=\"role.nameZh\" @keydown.enter.native=\"doAddRole\">\r\n      </el-input>\r\n      <el-button type=\"primary\" size=\"small\" icon=\"el-icon-plus\" @click=\"doAddRole\">添加角色</el-button>\r\n    </div>\r\n    <div class=\"permissionManaMain\">\r\n      <el-collapse accordion @change=\"change\" v-model=\"activeName\">\r\n        <el-collapse-item :title=\"r.nameZh\" :name=\"r.id\" v-for=\"(r,index) in roles\" :key=\"index\">\r\n          <el-card class=\"box-card\">\r\n            <div slot=\"header\" class=\"clearfix\">\r\n              <span>可访问的资源</span>\r\n              <el-button style=\"float: right; padding: 3px 0;color: #ff0000\" icon=\"el-icon-delete\" type=\"text\" @click=\"deleteRole(r)\" >\r\n              </el-button>\r\n            </div>\r\n            <div>\r\n              <el-tree show-checkbox node-key=\"id\" :default-checked-keys=\"selectedMenus\" ref=\"tree\" :key=\"index\"\r\n                  :data=\"allmenus\" :props=\"defaultProps\"></el-tree>\r\n              <div style=\"display: flex;justify-content: flex-end\">\r\n                <el-button size=\"mini\" @click=\"cancelUpdate\" >取消修改</el-button>\r\n                <el-button size=\"mini\" type=\"primary\" @click=\"doUpdate(r.id,index)\">确认修改</el-button>\r\n              </div>\r\n            </div>\r\n          </el-card>\r\n        </el-collapse-item>\r\n      </el-collapse>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"PermissionMana\",\r\n  data() {\r\n    return {\r\n      role: {\r\n        name: '',\r\n        nameZh: ''\r\n      },\r\n      roles:[],\r\n      allmenus:[],\r\n      activeName:-1,\r\n      selectedMenus:[],\r\n      defaultProps:{\r\n        children: 'children',\r\n        label:'name'\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.initRoles()\r\n  },\r\n  methods:{\r\n    deleteRole(role){\r\n      this.$confirm('此操作将永久【'+role.nameZh+'】角色, 是否继续?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        this.deleteRequest(\"/system/basic/permiss/role/\"+role.id).then(resp=>{\r\n          if(resp){\r\n            this.initRoles();\r\n          }\r\n        })\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '已取消删除'\r\n        });\r\n      });\r\n    },\r\n    doAddRole(){\r\n      if(this.role.name&&this.role.nameZh){\r\n        this.postRequest(\"/system/basic/permiss/role/\",this.role).then(resp=>{\r\n          if(resp){\r\n            this.role.nameZh=''\r\n            this.role.name=''\r\n            this.initRoles();\r\n          }\r\n        })\r\n      }else{\r\n        this.$message.error(\"数据不可以为空\")\r\n      }\r\n\r\n    },\r\n    cancelUpdate(){\r\n      this.activeName=-1\r\n    },\r\n    doUpdate(rid,index){\r\n      let tree = this.$refs.tree[index];\r\n      let selectedKeys = tree.getCheckedKeys(true);\r\n      let url='/system/basic/permiss/?rid='+rid;\r\n      selectedKeys.forEach(key=>{\r\n        url+='&mids='+key;\r\n      })\r\n      this.putRequest(url).then(resp=>{\r\n        if(resp){\r\n          this.activeName=-1;\r\n        }\r\n      })\r\n    },\r\n    change(rid){\r\n      if(rid){\r\n        this.initAllMenus();\r\n        this.initSelectedMenus(rid)\r\n      }\r\n    },\r\n    initSelectedMenus(rid){\r\n      this.getRequest(\"/system/basic/permiss/mids/\"+rid).then(resp=>{\r\n        if(resp){\r\n          this.selectedMenus=resp;\r\n        }\r\n      })\r\n    },\r\n    initAllMenus(){\r\n      this.getRequest(\"/system/basic/permiss/menus/\").then(resp=>{\r\n        if(resp){\r\n          this.allmenus = resp;\r\n        }\r\n      })\r\n    },\r\n    initRoles(){\r\n      this.getRequest(\"system/basic/permiss/\").then(resp=>{\r\n        if(resp){\r\n          this.roles=resp;\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.permissionManaMain {\r\n  margin-top: 10px;\r\n  width: 700px;\r\n}\r\n\r\n.permissionManaTool {\r\n  display: flex;\r\n  justify-content: flex-start;\r\n}\r\n\r\n.permissionManaTool .el-input {\r\n  width: 300px;\r\n  margin-right: 6px;\r\n}\r\n</style>"],"sourceRoot":"src/components/sys/basic"}]}